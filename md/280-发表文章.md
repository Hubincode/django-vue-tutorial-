把用户管理做的七七八八后，就可以继续愉快的开发博客文章有关的功能了，这才是博客的核心啊。

本章完成博客文章的发表。

## 准备工作

一般来说，博客是只允许博主自己发表文章的，因此很显然之前设计的接口是没有返回这方面的信息。

修改后端文件 `user_info/serializers.py` ，增加是否为超级用户的信息：

```python
# user_info/serializers.py

...
class UserRegisterSerializer(serializers.ModelSerializer):
    ...
    class Meta:
        ...
        fields = [
            ...
            'is_superuser'
        ]
        extra_kwargs = {
            ...
            'is_superuser': {'read_only': True}
        }
```

此外，由于博客文章的分类、标签通常不会太多。对这两个接口，为了方便起见我并不想翻页而是希望一次请求直接返回所有的数据。

所以修改后端文件 `article/views.py` ：

```python
# article/views.py
...
class TagViewSet(viewsets.ModelViewSet):
    ...
    pagination_class = None


class CategoryViewSet(viewsets.ModelViewSet):
    ...
    pagination_class = None

...
```

这样就可以了，并且不影响其他接口。

回到前端编写。

发表文章需要一个新的页面，因此新建 `frontend/src/views/ArticleCreate.vue` ：

```html
<!-- frontend/src/views/ArticleCreate.vue -->

<template>

    <BlogHeader/>


    <BlogFooter/>

</template>

<script>
    import BlogHeader from '@/components/BlogHeader.vue'
    import BlogFooter from '@/components/BlogFooter.vue'


    export default {
        name: 'ArticleCreate',
        components: {BlogHeader, BlogFooter}
    }
</script>
```

暂时有个空壳子就行了，后面再来填补内容。

接着，在用户登录时追加记录用户是否为超级管理员：

```html
<!-- frontend/src/views/Login.vue -->

...
<script>
    ...
    methods: {
        ...
        signin() {
            ...
            axios
                .post(...)
                .then(function (response) {
                    ...
                    // 是否为管理员
                    axios
                        .get('/api/user/' + that.signinName + '/')
                        .then(function (response) {
                            storage.setItem('isSuperuser.myblog', response.data.is_superuser);
                            // 路由跳转修改到这里
                            that.$router.push({name: 'Home'});
                    	});
                    	// .catch(...)
            })
        },
    }
</script>
....
```

将新页面的路由注册好：

```javascript
// frontend/src/router/index.js

...
import ArticleCreate from "@/views/ArticleCreate.vue";

const routes = [
    ...
    {
        path: "/article/create",
        name: "ArticleCreate",
        component: ArticleCreate
    },
];
```

最后，在页眉的欢迎词下拉框用 `v-if` 仅对超级用户显示入口，普通用户不显示：

```html
<!-- frontend/src/components/BlogHeader.vue -->

<template>
    ...
    <div class="dropdown-content">
        ...
        <router-link 
                 :to="{ name: 'ArticleCreate' }" 
                 v-if="isSuperuser"
                 >发表文章</router-link>
    </div>
    ...
</template>

<script>
...
data: function () {
    return {
        ...
        isSuperuser: JSON.parse(localStorage.getItem('isSuperuser.myblog')),
    }
},
...
</script>
```

准备工作就完成了。现在把鼠标悬停在页眉欢迎词上，如果是超级用户，下拉框中会出现“发表文章”的链接。

## 发表页面

